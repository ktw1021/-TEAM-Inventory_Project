<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="users">

    <!-- insert (가입) -->
    <insert id="insert" parameterType="UserVo">
        <selectKey keyProperty="userNo" resultType="string" order="BEFORE">
            SELECT seq_users_pk.nextval FROM dual
        </selectKey>
        INSERT INTO "user" (user_no, user_name, password, branch_id, auth_code)
        VALUES (#{userNo}, #{userName}, #{password}, #{branchId}, '0')
    </insert>
    
    <!-- name 정보로 사용자 정보 select (중복 가입 막기) -->
    <select id="selectUserByName" parameterType="string" resultType="UserVo">
        SELECT user_no AS userNo, user_name AS userName 
        FROM "user" 
        WHERE user_name = #{value}
    </select>
    
    <!-- name과 비밀번호로 사용자 정보 select (로그인) -->
    <select id="selectUserByNameAndPassword" parameterType="map" resultType="UserVo">
        SELECT user_no AS userNo, user_name AS userName, branch_id AS branchId, auth_code AS authCode 
        FROM "user" 
        WHERE user_name = #{userName} AND password = #{password}
    </select>
    
</mapper>
